version: '3'
services:
    reverseproxy:
        image: nginx:alpine
        container_name: reverse-proxy
        volumes:
            - ./nginx.conf:/etc/nginx/nginx.conf
        ports:
            - 80:80
            - 443:443
            - 8080:8080
        networks:
            - nginx-network

    cxr-png-imgsrv:
        depends_on:
            - reverseproxy
        image: nginx:alpine
        container_name: cxr-png-imgsrv
        expose:
            - "80"
        volumes:
            - /mnt/data/cxr/png:/usr/share/nginx/html
        networks:
            - nginx-network

    ris-flask:
        depends_on:
            - reverseproxy
        image: tsaiid/ris-flask
        container_name: ris-flask
        expose:
            - "8000"
        volumes:
            - /home/tsaiid/git/femh-ris/config:/app/config
        networks:
            - nginx-network

    cxr-ai-flask:
        depends_on:
            - reverseproxy
        image: tsaiid/cxr-ai-flask
        container_name: cxr-ai-flask
        expose:
            - "8000"
        volumes:
            - /home/tsaiid/git/femh-dicom/config:/app/config
        networks:
            - nginx-network

networks:
    nginx-network:
